#  股票问题

>  [!TIP] 建议0买入，1卖出，从上到下先买再买更加顺滑，当然1买入，0卖出也可以。

##  [121. 买卖股票的最佳时机](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock/)

![image-20221108120733463](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108120733463.png)

* 第一种解法 动态规划  dp[i][0代表第i天不持有股票的最大利润，dp【i，1】代表第i天持有股票的最大利润  递推公式很好理解，看下递推公式结合dp的含义就明白了。**因为股票只能买一次所以dp【i，1】一定是-price【i】**

  ![image-20221108121649409](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108121649409.png)

  空间优化版本：

  ![image-20221108151407818](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108151407818.png)

* 第二种解法 贪心 十分简单

  ![image-20221108121623740](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108121623740.png)



##  [122. 买卖股票的最佳时机 II](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/)

![image-20221108151902446](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108151902446.png)

题解：相比于121题没什么区别，dp【i】【1】计算方式变了，在121中只能买一次股票，所以dp【i】【1】始终是-price【i】，本题就变了。

* 解法一：最好理解了二维数组

  ![image-20221108163207418](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108163207418.png)

* 解法二：两个变量维护，但是没有问题，看图片解除疑惑

  ![image-20221108163336071](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108163336071.png)



##  [123. 买卖股票的最佳时机 III](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iii/)

![image-20221108173033537](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108173033537.png)

题解：一天有四种状态，第一次买入，第一次卖出，第二次买入，第二次卖出。最后取第二次卖出就可以了

* 解法一：延续上面两题，0表示第一次卖出，1表示第一次买入，2表示第二次卖出 ，3表示第二次买入，很别扭，但是是对的。递推公式很好理解，dp[i] [1]第一次买入：取最大的-price[i],  dp[i] [0]第一次卖出就和上面两题是一致的。随后是dp[i] [3]（第二次卖出） 利用第一次卖出来求，也就是利用dp[i] [0]来求。 第二次卖出dp[i] [2]同理，利用dp[i] [3]来求。

  ![image-20221108173501611](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108173501611.png)

* 解法二：换一下含义即可，0第一次买入，1第一次卖出，2第二次买入，3第二次卖出，从上到下就一气呵成了，不像第一种要绕一下顺序是1-0-3-2。

  ![image-20221108174206612](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108174206612.png)

* 解法三：一维滚动数组，完全一样的流程。



##  [188. 买卖股票的最佳时机 IV](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-iv/)

![image-20221108174347364](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108174347364.png)

题解：跟前一道题异曲同工，不过是从2 变成了2k（小技巧是将0，1摘出来单独初始化）

![image-20221108192422047](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108192422047.png)

## [309. 最佳买卖股票时机含冷冻期](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-with-cooldown/)

![image-20221108223129849](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108223129849.png)

题解：将每一天分成四个状态。

1. dp[i] [0] 是购入股票的最大利润。达到这个状态一是dp[i - 1] [0], 二是dp[i - 1] [1] - price[i]  ，三是dp[i - 1] [3] - price[i]前一天是冷静期，这三者取最大值。
2. **dp[i] [1] 这个需要重点理解**，保持卖出状态，意思是上一次卖出是第一天，第二天就变成了冷静期，那么第三天以及往后的都是保持卖出状态了，这个要多理解， dp[i ] [0]  = Math.max(dp[i - 1] [3], dp[i - 1] [0]) 取前一天的冷静期和dp[i - 1] [1]的最大值，想清楚找一个状态，这道题就迎刃而解了。
3. dp[i] [2] 这个状态是真正的今天卖出状态，一定是 dp[i - 1] [0] + price[i]
4. dp[i] [3] 冷静期状态，意思就是前一天卖出了呗，所以dp[i] [3] = dp[i - 1] [2]

![image-20221108225133534](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108225133534.png)



##  [714. 买卖股票的最佳时机含手续费](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-with-transaction-fee/)

![image-20221108230552963](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108230552963.png)

题解：第一种解法在买入时就支付手续费，第二种解法在卖出时候支付手续费，两种都可以，0代表买入，1代表卖出。买入时的公式是dp[i] [0] = Math.max(dp[i - 1] [0], **dp[i - 1] [1] - price[i]**),加粗部分格外注意，不再是纯的-price[i]了，因为这是有无限次的购买卖出机会的，会积累的，要用已经积累的卖出的总利润来减去price[i]。

![image-20221108231003197](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221108231003197.png)



# 状态机dp(需要补强)

## [790. 多米诺和托米诺平铺](https://leetcode.cn/problems/domino-and-tromino-tiling/)

![image-20221112225738962](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221112225738962.png)

![image-20221112225806042](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221112225806042.png)

参考题解：[多米诺和托米诺平铺 - 多米诺和托米诺平铺 - 力扣（LeetCode）](https://leetcode.cn/problems/domino-and-tromino-tiling/solution/duo-mi-nuo-he-tuo-mi-nuo-ping-pu-by-leet-7n0j/)

``` java
class Solution {
    static final int MOD = 1000000007;

    public int numTilings(int n) {
        int[][] dp = new int[n + 1][4];
        dp[0][3] = 1;
        for (int i = 1; i <= n; i++) {
            dp[i][0] = dp[i - 1][3];
            dp[i][1] = (dp[i - 1][0] + dp[i - 1][2]) % MOD;
            dp[i][2] = (dp[i - 1][0] + dp[i - 1][1]) % MOD;
            dp[i][3] = (((dp[i - 1][0] + dp[i - 1][1]) % MOD + dp[i - 1][2]) % MOD + dp[i - 1][3]) % MOD;
        }
        return dp[n][3];
    }
}

作者：LeetCode-Solution
链接：https://leetcode.cn/problems/domino-and-tromino-tiling/solution/duo-mi-nuo-he-tuo-mi-nuo-ping-pu-by-leet-7n0j/
来源：力扣（LeetCode）
```

## [799. 香槟塔](https://leetcode.cn/problems/champagne-tower/) mid

![image-20221120230322692](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221120230322692.png)

![image-20221120230341605](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221120230341605.png)

动态规划：针对于第row行第column列（dp[row] [column]）的这个酒杯，有机会能够注入到它的“上层”酒杯只会是dp[row-1] [column-1]和dp[row-1] [column]，那么这里是“有机会”，因为只有这两个酒杯都满了（减1）的情况下，才会注入到dp[row] [column]这个酒杯中，所以，我们可以得到状态转移方程为：

dp[row] [column] = Math.max(dp[row-1] [column-1]-1, 0)/2 + Math.max(dp[row-1] [column]-1, 0)/2。

代码：避免边界判断，数组多开一个长度，dp[1] [1] 表示0，0位置

``` java
public double champagneTower(int poured, int query_row, int query_glass) {
        double[][] dp = new double[query_row + 2][query_row + 2];
        dp[1][1] = poured;
        for (int row = 2; row <= query_row + 1; row++) {
            for (int column = 1; column <= row; column++) {
                dp[row][column] = Math.max(dp[row - 1][column - 1] - 1, 0) / 2 + Math.max(dp[row - 1][column] - 1, 0) / 2;
            }
        }
        return Math.min(dp[query_row + 1][query_glass + 1], 1);
    }
```



作者：muse-77
链接：https://leetcode.cn/problems/champagne-tower/solution/by-muse-77-cck9/
来源：力扣（LeetCode）
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

## [808. 分汤](https://leetcode.cn/problems/soup-servings/)

![image-20221121223554814](https://cdn.jsdelivr.net/gh/Miyuki7/image-host/blog-imgimage-20221121223554814.png)